# V2（插件端）：从微信公众号文章页抓取并同步到多平台（总览）

## 0. 文档说明
- 本文为 V2 总览文档，拆分后的子需求文档见：
  - 通用依赖：`V2-0`
  - 模块拆分：`V2-1` ~ `V2-4`
  - 渠道拆分：`V2-5` ~ `V2-14`

## 1. 定位
- 浏览器插件是独立产品，与网站端（网站代码/部署）解耦、互不依赖。
- 目的：用户在浏览器中打开已发布的微信公众号文章页（`mp.weixin.qq.com`），通过页面内注入的发布面板，将文章内容抓取、转换后同步到目标平台。

## 2. 本期范围（必须）
### 2.1 目标渠道（本期必须覆盖）
本期仅覆盖以下渠道（共 10 个）：
- CSDN（`csdn`）
- 腾讯云开发者社区（`tencent-cloud-dev`）
- 博客园（`cnblogs`）
- OSCHINA（`oschina`）
- 人人都是产品经理（`woshipm`）
- 墨问（`mowen`）
- 少数派（`sspai`）
- 百家号（`baijiahao`）
- 头条号（`toutiao`）
- 飞书文档（`feishu-docs`）

> 说明：以上渠道列表来自现有渠道枚举，本 PRD 不讨论其代码字段/状态。

### 2.2 不在本次需求范围
- 微信公众号（`wechat`）作为“目标发布渠道”不在本期范围（但依然是本产品的抓取来源页）。
- 知乎（`zhihu`）不在本期范围。
- 掘金（`juejin`）不在本期范围。

### 2.3 图片策略（本期）
- 本期不开发“图片上传”功能。
- 图片默认优先复用原文外链；若目标平台不允许外链或出现图片异常，需在面板内给出用户可理解的提示与处理建议（详见 `V2-4`）。

## 3. 入口与触发
- 用户打开某篇 `mp.weixin.qq.com` 文章页。
- 插件在页面内注入发布面板（最小可用面板，详见 `V2-2`）。
- 用户在面板选择目标渠道与动作，点击开始后，插件从当前页面抓取内容并进入执行流程（详见 `V2-3`）。

## 4. 数据抓取与转换（需求级）
### 4.1 抓取内容（最小集合）
- 标题
- 正文 HTML（以页面渲染后的内容为准）
- 原文链接（当前页面 URL）

### 4.2 可选抓取（尽量做但允许缺省）
- 作者/公众号名、发布时间
- 封面图/首图（若页面可可靠获取）

### 4.3 转换
- 从 HTML 生成目标平台需要的格式（HTML/Markdown 等），按渠道适配。
- 由于本期不做图片上传，涉及图片的平台差异需在面板与诊断区给出明确提示与建议。

## 5. 支持动作
- 保存草稿
- 直接发布（要求：最终确认发布成功，详见 `V2-0` 与 `V2-4` 对“成功可见标准”的定义）

## 6. 失败处理（以提示为主）
失败时必须在插件面板的诊断区输出可读提示（详见 `V2-4`）：
- 目标平台未登录：提示用户先登录后重试。
- 触发风控/验证码：提示用户在当前标签页手动完成后继续。
- 内容超限/格式不支持：提示并给出精简建议（例如移除复杂样式、缩短标题/摘要等）。
- DOM 结构变更导致抓取/填表失败：提示并输出可诊断信息（页面类型、关键节点缺失等）。

## 7. 安全与隐私
- 插件不上传/不回传第三方平台 cookies 或敏感 token。
- 各平台登录态仅在用户本地浏览器中使用，插件仅在对应平台页面内执行操作。

## 8. 可扩展性
- 渠道以“适配器”方式扩展：新增平台只新增一份适配逻辑，不影响现有渠道（详见 `V2-3`）。
