# V2-0：通用依赖（范围、术语、数据、动作、环境与诊断）

## 1. 目的与范围
- 本文定义 V2 系列需求的通用约束与通用验收口径。
- 本文不包含任何实现/代码层细节。

## 2. 术语
- 抓取源：微信公众号文章页（`mp.weixin.qq.com`），作为内容来源。
- 发布渠道：本期目标平台（仅 `csdn / tencent-cloud-dev / cnblogs / oschina / woshipm / mowen`）。
- 发布面板：注入在抓取源页面内的 UI 面板，用于配置渠道与动作、查看诊断信息。
- 诊断区：发布面板的一部分，用于显示用户可读提示与（本地开发时）详细调试信息（见 `V2-4`）。

## 3. 数据字段（需求级）
### 3.1 最小集合（必须）
- 标题（string）
- 正文 HTML（string，以渲染后为准）
- 原文链接（string，当前页面 URL）

### 3.2 可选字段（尽量做但允许缺省）
- 作者/公众号名（string）
- 发布时间（string 或可解析时间）
- 封面图/首图 URL（string）

## 4. 动作定义与成功标准（验收口径）
### 4.1 保存草稿
定义：将内容写入目标平台的草稿/未发布状态。

成功可见标准（满足其一即可）：
- 目标平台页面出现明确的“草稿已保存/已保存”提示或状态标识；或
- 打开草稿列表/管理页可以看到新增或更新的草稿；或
- 页面 URL/标题/状态发生可验证变化，能够证明草稿已落地（以平台实际交互可见为准）。

### 4.2 直接发布
定义：完成发布提交链路，并最终确认文章已发布成功。

成功可见标准（满足其一即可）：
- 页面出现明确的“发布成功/已发布”提示，并能访问到发布后的文章页面；或
- 自动跳转到已发布文章详情页；或
- 打开内容管理/文章列表可见该文章为“已发布”状态（以平台实际交互可见为准）。

## 5. 图片策略（本期）
- 本期不开发图片上传功能。
- 图片默认复用原文外链。
- 若目标平台限制外链或导致图片不可用：必须在诊断区给出用户可理解的提示与处理建议（见 `V2-4`），例如“请手动重新上传图片/替换为平台支持的图片来源”。

## 6. 安全与隐私（通用约束）
- 插件不上传/不回传第三方平台 cookies 或敏感 token。
- 各平台登录态仅在用户本地浏览器中使用，插件仅在对应平台页面内执行操作。

## 7. 开发/生产与诊断信息显示（通用约束）
- 诊断区需要支持两级信息：
  - 用户可读提示：默认展示。
  - 详细调试信息：仅在“本地开发构建”时展示（见 `V2-4`）。
- “本地开发构建/生产构建”的区分由构建脚本的现有判断方式决定（例如环境变量 `BUILD_TARGET`），开发过程中无需额外关心或手动配置该显示策略。

## 8. 依赖关系
- 本文被 `V2-1` ~ `V2-10` 全部引用。
- 诊断区的具体字段与展示规范以 `V2-4` 为准。
